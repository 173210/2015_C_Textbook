<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <title>第7章 ～ループとファイル分割～</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sanitize.css/2.0.0/sanitize.min.css">
    <link rel="stylesheet" href="./css/style.css">
    <script src="./syntaxhighlighter/scripts/shCore.js" type="text/javascript"></script>
    <script src="./syntaxhighlighter/scripts/shBrushPlain.js" type="text/javascript"></script>
    <script src="./syntaxhighlighter/scripts/shBrushCpp_kai.js" type="text/javascript"></script>
    <link href="./syntaxhighlighter/styles/shCore.css" rel="stylesheet" type="text/css">
    <link href="./syntaxhighlighter/styles/shThemeMidnight_likeVS.css" rel="stylesheet" type="text/css">
    <script src="./scripts/common.js" type="text/javascript"></script>
    <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>
</head>
<body>
    <h1>第7章 ～ループとファイル分割～</h1>
    <nav class="top">
        <ul>
            <li><a href="./06conditional_state.html" title="前頁">prev</a></li>
            <li><a href="index.html" title="目次">main</a></li>
            <li><a href="./08preprocess_and_constant.html" title="次頁">next</a></li>
        </ul>
    </nav>
    <section>
        <h2>while文</h2>
        <p>プログラミング言語へのループ文の導入は画期的なものでした。while文はC言語におけるもっとも簡単なループ文です。</p>
        <pre class="brush: cpp;">while(継続条件) 実行文;</pre>
        <p>if文と同様、実行文は{}を使って複数行書くことができます。例を見てみましょう。</p>
        <pre class="brush: cpp;">while('\n' != getchar());</pre>
        <p>例えば、</p>
        <pre class="brush: cpp;">#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
int getnum(void){
	char s[100];
	long t;
	char *endptr;
	fgets(s, 100, stdin);
	errno = 0;
	t = strtol(s, &endptr, 10);
	if (errno != 0 || *endptr != '\n' || (t < INT_MIN || INT_MAX < t))
		return -1;
	return t;
}
int main(){
	int num;
	int sum = 0;
	while (1){
		printf("数値を入力してください(-1で終了):");
		num = getnum();
		if (num == -1)
			break;
		sum += num;
	}
	printf("入力した数値の合計は%dです。\n", sum);
	return 0;
}
</pre>
        <section>
            <h3>問題</h3>
            <p>unsigned intのビット数を求めてみよう！</p>
            <form><input type="button" value="表示/非表示" onclick="change_answer_state('answer1')"></form>
            <section id="answer1" style="display: none;">
                <h4>回答</h4>
                <pre class="brush: cpp;">
#include&lt;stdio.h&gt;
/*--- unsigned型のビット数を返却 ---*/
int int_bits(void)
{
	int count = 0;
	unsigned x = ~0U;
	while (x) {
		if (x & 1U) count++;
		x >>= 1;
	}
	return count;
}
int main(){
	int int_no_bits;
	int_no_bits = int_bits();
	printf("unsigned_int型のビット数は%dで、%dバイトです。\n",int_no_bits,int_no_bits/8);
	return 0;
}</pre>
            </section>
        </section>
    </section>
    <section>
        <h2>for文</h2>
        <p>はっきり言って、for文のほうがwhile文より使いやすいです。そしてfor文はこのあと説明する配列と殆どの場合一緒に使います。</p>
        <pre class="brush: cpp;">for(初期化文; 継続条件; カウンター等実行文);</pre>
        <pre class="brush: cpp;">for(unsigned int i = 0, sum = 0; i &lt; 10; i++) sum += i;</pre>
        <p>こんな感じ。まあそのうち呼吸をするがごとく登場するので、これ以上は例を上げないでおきます。実用的な例を上げたほうが良いもんね、やっぱり。</p>
    </section>
    <section>
        <h2>do-while文</h2>
        <p>事後評価文とでも言えばいいのでしょうか。whileと違い、一度実行し、それからループするかを判断します。</p>
        <pre class="brush: cpp;">do{
    //実行文
}while(継続条件)</pre>
        <p>これまた多くの場合、ポインターや標準入力とともに使うので実例はその時に。</p>
    </section>
    <section>
        <h2>ソースファイルを分ける</h2>
        <p>一つのファイルですべてのソースコードを書くと、コンパイル時間が増加する要因となり、また見通しの悪いプログラムになりやすい(はい、私です。いっつもファイルを分けるのをめんdいからやらないのは)です。</p>
        <p>
            先に、プロトタイプ宣言はソースコードの冒頭に、と言いましたが、この内外部公開するものはヘッダーファイルに書きます。この他にヘッダーファイルに書くものとしては、共通してincludeするファイルや、公開する構造体定義や列挙型定義などです。<br>
            通常変数やinline関数のプロトタイプ宣言を書くのはいろいろ面倒なので(externすればいいが)、あまりしません。とくに変数を共有しなければならないことは極めて稀だと思います。
            例を見ましょう。
        </p>
        <pre class="brush: cpp;" title="arikitari.h">#ifndef INC_ARIKITARI_H
#define INC_ARIKITARI_H
#if (defined(_MSC_VER) && _MSC_VER > 1000) || (defined(__clang__) && (__clang_major__ > 3 || (__clang_major__ == 3 && __clang_minor__ > 2))) ||(defined(__ICC) && __ICC > 1000) ||defined (__GNUC__) && !defined(__ICC) && !defined(__clang__) && (__GNUC__ >= 4 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#pragma once
#endif
int get_integer_num(const int max, const int min);
#endif INC_ARIKITARI_H</pre>
        <pre class="brush: cpp;" title="arikitari.c">#include "arikitari.h"
#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
#include&lt;limits.h&gt;//in gcc
#include&lt;errno.h&gt;//in gcc
int get_integer_num(const int max, const int min){
    //中略
}</pre>
        <pre class="brush: cpp;" title="main.c">#include "arikitari.h"
#include&lt;stdio.h&gt;
#include&lt;limits.h&gt;
int main(void){
    const int input = get_integer_num(INT_MAX, INT_MIN);
    printf("input=%d", input);
    return 0;
}</pre>
        <p>ヘッダーファイルは必ず関数定義があるファイルと関数使用箇所両方でincludeするようにします。また、ヘッダーファイルの名前は普通関数定義があるファイル名と同じにします。</p>
        <p>何度も言いますが、すべての関数を公開する、ヘッダーファイルで宣言する必要はありません。あくまで他のファイルからも使いたい関数等を公開するわけです。</p>
        <pre class="brush: cpp; first-line: 3;">#if (defined(_MSC_VER) && _MSC_VER > 1000) || (defined(__clang__) && (__clang_major__ > 3 || (__clang_major__ == 3 && __clang_minor__ > 2))) ||(defined(__ICC) && __ICC > 1000) ||defined (__GNUC__) && !defined(__ICC) && !defined(__clang__) && (__GNUC__ >= 4 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))</pre>
        <p>は、#pragma onceに対応していないコンパイラー(というよりプリプロセッサか)に対応するものです。詳細はプリプロセッサの項目で。</p>
    </section>

    <nav class="bottom">
        <ul>
            <li><a href="./06conditional_state.html" title="前頁">prev</a></li>
            <li><a href="index.html" title="目次">main</a></li>
            <li><a href="./08preprocess_and_constant.html" title="次頁">next</a></li>
        </ul>
    </nav>
</body>
</html>